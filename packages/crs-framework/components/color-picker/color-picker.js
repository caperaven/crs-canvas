import"./color-gradient.js";import"./color-panel.js";class l extends crsbinding.classes.BindableElement{#e;#l;#n;#s;#t;#i=!1;#c=this.#y.bind(this);#h=this.#b.bind(this);#a=this.#v.bind(this);#g=this.#x.bind(this);#u=this.#f.bind(this);#r=this.#C.bind(this);#o;#d;get shadowDom(){return!0}get html(){return import.meta.url.replace(".js",".html")}get baseColor(){return this.getAttribute("value")}set baseColor(t){this.value=t,this.setAttribute("value",t),this.dispatchEvent(new CustomEvent("change"))}static get observedAttributes(){return["value"]}async connectedCallback(){await super.connectedCallback(),this.#e=this.getBoundingClientRect(),this.#l=this.panel.getBoundingClientRect(),this.#n=this.gradient.getBoundingClientRect(),this.panel.setAttribute("value",this.baseColor||"#FF0000"),this.registerEvent(this.panel,"mousedown",this.#c),this.registerEvent(this.gradient,"mousedown",this.#g)}async disconnectedCallback(){this.#e=null,this.#l=null,this.#n=null,this.#s=null,this.#t=null,this.#i=null,this.#c=null,this.#h=null,this.#a=null,this.#g=null,this.#u=null,this.#r=null,this.#o=null,this.#d=null,super.disconnectedCallback()}async attributeChangedCallback(t,s,i){this.panel?.setAttribute("value",i)}async#y(t){t.preventDefault(),this.#o=this.panel.getContext("2d",{willReadFrequently:!0}),this.#i=!0,this.#s=t.clientX-this.#e.x,this.#t=t.clientY-this.#e.y,this.registerEvent(document,"mousemove",this.#h),this.registerEvent(document,"mouseup",this.#a),await this.#p()}async#b(t){t.preventDefault();const s=n({x:t.clientX,y:t.clientY},this.#l);this.#s=s.x-this.#e.left,this.#t=s.y-this.#e.top;const i=this.panel.get(this.#s,this.#t)}async#v(t){t.preventDefault(),this.#i=!1,this.unregisterEvent(document,"mousemove",this.#h),this.unregisterEvent(document,"mouseup",this.#a),this.#s=null,this.#t=null,this.#o=null}async#p(){requestAnimationFrame(()=>{this.#i!=!1&&(this.panelSelector.style.translate=`${this.#s-8}px ${this.#t-8}px`,this.#p())})}async#m(){requestAnimationFrame(()=>{this.#i!=!1&&(this.gradientSelector.style.translate=`0px ${this.#t-4}px`,this.#m())})}async#x(t){t.preventDefault(),this.#d=this.gradient.getContext("2d",{willReadFrequently:!0}),this.#i=!0,this.#t=t.clientY-this.#e.y,this.registerEvent(document,"mousemove",this.#u),this.registerEvent(document,"mouseup",this.#r),await this.#m()}async#f(t){t.preventDefault();const s=n({x:t.clientX,y:t.clientY},this.#n);this.#t=s.y-this.#e.top;const i=this.gradient.get(1,this.#t);await this.panel.pushUpdate(i)}async#C(t){t.preventDefault();const s=n({x:t.clientX,y:t.clientY},this.#n);this.#t=s.y-this.#e.top;const i=this.gradient.get(1,this.#t);await this.panel.pushUpdate(i),this.#i=!1,this.unregisterEvent(document,"mousemove",this.#u),this.unregisterEvent(document,"mouseup",this.#r),this.#t=null,this.#s=null,this.#d=null}}function n(e,t){return e.x<t.x&&(e.x=t.x),e.x>t.right&&(e.x=t.right),e.y<t.y&&(e.y=t.y),e.y>t.bottom-1&&(e.y=t.bottom-1),e}customElements.define("color-picker",l);
